!function(a){a.fn.pbtStickySidebar=function(b){function c(a,b){return!0===a.initialized|| !($("body").width()<a.minWidth)&&(d(a,b),!0)}function d(a,b){a.initialized=!0,b.each(function(){let b={};if(b.sidebar=$(this),b.options=a||{},b.container=$(b.options.containerSelector),0==b.container.length&&(b.container=b.sidebar.parent()),b.sidebar.parent().css("-webkit-transform","none"),b.sidebar.css({position:b.options.defaultPosition,overflow:"visible","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"}),b.stickySidebar=b.sidebar.find(".pbtStickySidebar"),0==b.stickySidebar.length){var f,g,i=/(?:text|application)\/(?:x-)?(?:javascript|ecmascript)/i;b.sidebar.find("script").filter(function(b,a){return 0===a.type.length||a.type.match(i)}).remove(),b.stickySidebar=$("<div>").addClass("pbtStickySidebar").append(b.sidebar.children()),b.sidebar.append(b.stickySidebar)}b.marginBottom=parseInt(b.sidebar.css("margin-bottom")),b.paddingTop=parseInt(b.sidebar.css("padding-top")),b.paddingBottom=parseInt(b.sidebar.css("padding-bottom"));let c=b.stickySidebar.offset().top,d=b.stickySidebar.outerHeight();function h(){b.fixedScrollTop=0,b.sidebar.css({"min-height":"1px"}),b.stickySidebar.css({position:"static",width:"",transform:"none"})}b.stickySidebar.css("padding-top",1),b.stickySidebar.css("padding-bottom",1),c-=b.stickySidebar.offset().top,d=b.stickySidebar.outerHeight()-d-c,0==c?(b.stickySidebar.css("padding-top",0),b.stickySidebarPaddingTop=0):b.stickySidebarPaddingTop=1,0==d?(b.stickySidebar.css("padding-bottom",0),b.stickySidebarPaddingBottom=0):b.stickySidebarPaddingBottom=1,b.previousScrollTop=null,b.fixedScrollTop=0,h(),b.onScroll=function(b){if(!b.stickySidebar.is(":visible"))return;if($("body").width()<b.options.minWidth||b.options.disableOnResponsiveLayouts&&b.sidebar.outerWidth("none"==b.sidebar.css("float"))+50>b.container.width()){h();return}let d=$(document).scrollTop(),g="static",c=0;if(d>=b.sidebar.offset().top+(b.paddingTop-b.options.additionalMarginTop)){let k,n=b.paddingTop+a.additionalMarginTop,o=b.paddingBottom+b.marginBottom+a.additionalMarginBottom,p=b.sidebar.offset().top,q=b.sidebar.offset().top+(k=(v=b.container).height(),v.children().each(function(){k=Math.max(k,$(this).height())}),k),j=0+a.additionalMarginTop,i,r=b.stickySidebar.outerHeight()+n+o<$(window).height();i=r?j+b.stickySidebar.outerHeight():$(window).height()-b.marginBottom-b.paddingBottom-a.additionalMarginBottom;let s=p-d+b.paddingTop,t=q-d-b.paddingBottom-b.marginBottom;c=b.stickySidebar.offset().top-d;let l=b.previousScrollTop-d;"fixed"==b.stickySidebar.css("position")&&"modern"==b.options.sidebarBehavior&&(c+=l),"stick-to-top"==b.options.sidebarBehavior&&(c=a.additionalMarginTop),"stick-to-bottom"==b.options.sidebarBehavior&&(c=i-b.stickySidebar.outerHeight()),c=l>0?Math.min(c,j):Math.max(c,i-b.stickySidebar.outerHeight()),c=Math.max(c,s),c=Math.min(c,t-b.stickySidebar.outerHeight());var v,m=b.container.height()==b.stickySidebar.outerHeight();g=(m||c!=j)&&(m||c!=i-b.stickySidebar.outerHeight())?d+c-b.sidebar.offset().top-b.paddingTop<=a.additionalMarginTop?"static":"absolute":"fixed"}if("fixed"==g){let u=$(document).scrollLeft();b.stickySidebar.css({position:"fixed",width:e(b.stickySidebar)+"px",transform:"translate3d(0, "+c+"px, 0)",left:b.sidebar.offset().left+parseInt(b.sidebar.css("padding-left"))-u+"px",top:"0px"})}else if("absolute"==g){let f={};"absolute"!=b.stickySidebar.css("position")&&(f.position="absolute",f.transform="translate3d(0, "+(d+c-b.sidebar.offset().top-b.stickySidebarPaddingTop-b.stickySidebarPaddingBottom)+"px, 0)",f.top="0px"),f.width=e(b.stickySidebar)+"px",f.left="",b.stickySidebar.css(f)}else"static"==g&&h();"static"!=g&& !0==b.options.updateSidebarHeight&&b.sidebar.css({"min-height":b.stickySidebar.outerHeight()+b.stickySidebar.offset().top-b.sidebar.offset().top+b.paddingBottom}),b.previousScrollTop=d},b.onScroll(b),$(document).on("scroll."+b.options.namespace,(f=b,function(){f.onScroll(f)})),$(window).on("resize."+b.options.namespace,(g=b,function(){g.stickySidebar.css({position:"static"}),g.onScroll(g)}))})}function e(b){let a;try{a=b[0].getBoundingClientRect().width}catch(c){}return void 0===a&&(a=b.width()),a}return(b=a.extend({containerSelector:"",additionalMarginTop:0,additionalMarginBottom:0,updateSidebarHeight:!0,minWidth:0,disableOnResponsiveLayouts:!0,sidebarBehavior:"modern",defaultPosition:"relative",namespace:"PBT"},b)).additionalMarginTop=parseInt(b.additionalMarginTop)||0,b.additionalMarginBottom=parseInt(b.additionalMarginBottom)||0,function(a,b){let d=c(a,b);if(!d){var e,f,g,h;console.log("PBT: Body width smaller than options.minWidth. Init is delayed."),$(document).on("scroll."+a.namespace,(e=a,f=b,function(a){let b=c(e,f);b&&$(this).unbind(a)})),$(window).on("resize."+a.namespace,(g=a,h=b,function(a){let b=c(g,h);b&&$(this).unbind(a)}))}}(b,this),this}}(jQuery);
